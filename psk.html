<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSK Estate - Plantation and Agronomy Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .details-content { display: none; }
        .details-content.active { display: block; }
        .dropdown-btn.active { background-color: #4a5568; }
        .policy-item { border-left: 3px solid #6366f1; padding-left: 1rem; margin-top: 0.75rem; }
        .modal { display: none; }
        .modal.active { display: flex; }
        .chart-container { position: relative; height: 300px; width: 100%; margin: auto; }
        .pie-chart-container { position: relative; height: 350px; width: 100%; margin: auto; }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-md">
        <nav class="container mx-auto px-6 py-4 flex items-center justify-between">
            <div class="text-xl font-bold text-gray-900">
                <a href="index.html" class="flex items-center">
                    PSK Estate Report
                </a>
            </div>
            <a href="estates.html" class="text-indigo-600 hover:text-indigo-800 transition duration-300">&larr; Back to Estates List</a>
        </nav>
    </header>

    <!-- Main container for the report -->
    <div class="container mx-auto p-4 md:p-8">
        <!-- Container where the estate data will be rendered -->
        <div id="selected-estate-container" class="grid grid-cols-1 gap-8">
             <!-- Content will be generated by JavaScript -->
        </div>
    </div>
    
    <!-- Modal for displaying policy details -->
    <div id="policyModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-2xl font-bold">Agricultural Policy Cross-Reference</h3>
                <button onclick="closePolicyModal()" class="text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
            </div>
            <div id="modalContent" class="space-y-4 overflow-y-auto pr-4 flex-grow">
                <!-- Modal content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Main script for application logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA STORE ---
            // Data for this specific estate page.
            const estateData = {"id":"psk","name":"PSK Estate","reportInfo":"Data based on Agronomy & PA Reports (June 2024 - March 2025).","summaryMetrics":{"area":{"title":"Estate Area","lines":["Mature: 1,999.83 ha","Immature: 0.00 ha","Total: 1,999.83 ha"]},"yield":{"title":"Yield/Ha (Actual vs Budget)","value":"6.17 / 7.91 MT","note":"For 6 months (Jan-Jun 2024)"},"cost":{"title":"FFB Cost/Tonne (Actual vs Budget)","value":"RM 251.99 / RM 417.95","note":"Ex-Estate, 6 months"},"weeding":{"title":"Weeding Progress","value":"49%","note":"Overall, as of Jun 2024"},"manuring":{"title":"Manuring Progress","value":"31%","note":"Overall, as of Jun 2024"}},"keyMetrics":[{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-blue-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z' /></svg>","label":"Labour Ratio","value":"1:29 ha (Harvester)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-green-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' /></svg>","label":"P&D Status","value":"Action Required (Rats)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-yellow-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 10V3L4 14h7v7l9-11h-7z' /></svg>","label":"OER %","value":"16.11% (Actual)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z' /></svg>","label":"Harvester Prod.","value":"1.8 MT/md (Low)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-purple-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z' /></svg>","label":"Harvest Interval","value":"19 days (Average)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-teal-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17.657 18.343A8 8 0 016.343 7.029m11.314 11.314a8 8 0 01-11.314-11.314m2.121 13.435a2 2 0 01-2.828 0l-2.122-2.121a2 2 0 010-2.828l5.656-5.657a2 2 0 012.829 0l2.121 2.121a2 2 0 010 2.828l-5.657 5.657z' /></svg>","label":"Nutrient Status","value":"Suboptimal (Mg Deficiency)"}],"chartData":{"production":{"labels":["Jan-24","Feb-24","Mar-24","Apr-24","May-24","Jun-24","Jul-24","Aug-24","Sep-24","Oct-24","Nov-24","Dec-24"],"ffb":[1800,2000,2500,2800,3200,3500,3000,2900,2700,2500,2300,2100],"rainfall":[1485,51,103,153,85,180,75,128,187.5,321,554,448],"note":"*FFB production data for July-Dec 2024 is estimated based on reported trends."},"ageProfile":{"labels":["0-3 Years","4-7 Years","8-19 Years","20-25 Years",">26 Years"],"data":[0,10,60,30,0],"title":"PSK Estate Palm Age Distribution","note":"*Hypothetical age distribution focusing on prime age."}},"observations":["<b>Harvester Shortage & Low Productivity:</b> Critical shortage of harvesters and low output, leading to extended harvesting intervals and crop loss. (PA Report, Pg. 51; Agronomy Report, Pg. 48)","<b>Delayed Manuring Program:</b> Significant delays in fertilizer application in 2024 and slow progress in 2025, impacting yield potential and palm health. (PA Report, Pg. 51; Agronomy Report, Pg. 11-13)","<b>Backlog Pruning & Poor Canopy Management:</b> Pruning program significantly behind schedule, resulting in under-pruned palms and hindering harvesting efficiency. (PA Report, Pg. 52; Agronomy Report, Pg. 25-26)","<b>High Rat Damage:</b> Significant rat infestation (over 10% in many blocks) with insufficient baiting and poor barn owl box maintenance. (PA Report, Pg. 52; Agronomy Report, Pg. 43-44)"],"reports":{"agronomy":{"Executive Summary":"Palm census is progressing slower than expected. The manuring program for 2024 was incomplete and 2025 progress is slow. Crop recovery is unsatisfactory due to prolonged harvesting intervals and incomplete loose fruit collection, leading to significant over-ripe bunches. Palm nutrient status is suboptimal, and pruning remains a major issue. Weed control is slow, and rat infestation is high with insufficient baiting.","Nutrient Inputs/Progress of Manuring":"Only 67% of the 2024 manuring program was completed due to flooding and late deliveries (Agronomy Report, Pg. 11). As of March 2025, only 5% of the first half's program is complete. The fertilizer store has a leaking roof, risking quality (Agronomy Report, Pg. 13). Expediting application is crucial.","Agronomic Observation":"Harvesting intervals exceeded 15 days in 2024, leading to poor crop recovery and over-ripe/rotten bunches (Agronomy Report, Pg. 25). Palm appearance is unsatisfactory, especially in peat soil areas, with yellowing and premature frond snapping. Pruning is significantly behind schedule (only 1% completed in Feb 2025). Weed control is slow, with undesirable grasses and broadleaf weeds present. High rat damage (over 10% in many blocks) with insufficient baiting and poor barn owl box maintenance (Agronomy Report, Pg. 43).","Yield Performance":"Yield in 2024 increased by 1% compared to the previous year but remains below the regional trend. For Jan-Feb 2025, yield improved by 22% compared to last year, though PM05C and PM05D declined. Low production is due to extended harvesting intervals (65% of target rounds achieved) and harvester shortage (1.10-1.40 MT/md productivity). Incomplete fertilizer programs and low average bunch weight (11.05 kg) are also limiting factors (Agronomy Report, Pg. 48).","Fertilizer Recommendation":"No amendments to the 2025 fertilizer program. The estate is advised to expedite application immediately after the rainy season and ensure proper drainage to prevent waterlogging."},"plantation":{"Executive Summary":"PSK Estate is facing a critical shortage of harvesters and sprayers, leading to high turnover due to low wages. The manuring program is significantly delayed, and there's a substantial backlog in pruning. Harvester productivity is low, and the Vehicle Running Account records require immediate correction.","Area Statement":"The total mature planted area is 1,999.83 ha, with 0.00 ha immature. There has been no change in the area statement, and no replanting is scheduled for 2025.","Labour Statement":"There is a critical shortage of 12 harvesters (actual ratio 1:29 ha vs 1:25 ha required) and 4 sprayers. High turnover is attributed to low harvesting rates. 16 out of 23 new recruits left the estate (PA Report, Pg. 51)."}},"policy":" <div class='policy-item'><p class='font-semibold'>Harvester Productivity & Crop Recovery</p><p class='text-sm text-gray-600'><b>Policy 12.6:</b> Maintain high harvesting standards; collect all loose fruits. (Pg. 128)</p><p class='text-sm text-gray-600'><b>Policy 12.3:</b> Ideal harvesting interval 10-12 days. (Pg. 127)</p></div> <div class='policy-item'><p class='font-semibold'>Delayed Manuring Program</p><p class='text-sm text-gray-600'><b>Policy 8.4.1 A:</b> Ensure timely fertilizer application, avoiding heavy/low rainfall periods; proper planning. (Pg. 82-83)</p></div> <div class='policy-item'><p class='font-semibold'>Pruning Backlog & Canopy Management</p><p class='text-sm text-gray-600'><b>Policy 11.01:</b> Pruning is for practical purposes; avoid over-pruning. (Pg. 124)</p><p class='text-sm text-gray-600'><b>Policy 11.1.2 a:</b> Retain two fronds below lowest bunches. (Pg. 124)</p><p class='text-sm text-gray-600'><b>Policy 11.3:</b> Stack pruned fronds neatly in inter-lines. (Pg. 125)</p></div> <div class='policy-item'><p class='font-semibold'>High Rat Damage</p><p class='text-sm text-gray-600'><b>Policy 9.1.3 iii:</b> Conduct regular rat baiting if damage >5%. (Pg. 118)</p><p class='text-sm text-gray-600'><b>Policy 9.1.3 i:</b> Encourage barn owls; use warfarin baits if needed. (Pg. 120)</p></div>"};

            // --- GLOBAL VARIABLES ---
            let chartInstances = {}; // To keep track of created charts for proper destruction
            const container = document.getElementById('selected-estate-container');

            // --- FUNCTIONS ---

            /**
             * Renders the full report for the estate.
             */
            function renderEstate() {
                container.innerHTML = createEstateHTML(estateData);
                
                // Use a short timeout to ensure the DOM is updated before initializing charts and events
                setTimeout(() => {
                    initializeChartsForEstate(estateData);
                    populateInternalDropdowns(estateData);
                    attachEventListeners(estateData);
                }, 0);
            }

            /**
             * Creates the HTML string for the estate's report.
             * @param {object} estate - The data object for a single estate.
             * @returns {string} The complete HTML for the estate's report view.
             */
            function createEstateHTML(estate) {
                const summaryMetricsHTML = Object.values(estate.summaryMetrics).map(metric => {
                    const colorClass = metric.title.includes('Area') ? 'bg-blue-50 text-blue-800' : 
                                       metric.title.includes('Yield') ? 'bg-green-50 text-green-800' :
                                       metric.title.includes('Cost') ? 'bg-red-50 text-red-800' :
                                       metric.title.includes('Weeding') ? 'bg-yellow-50 text-yellow-800' : 'bg-purple-50 text-purple-800';
                    if (metric.lines) {
                        return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3>${metric.lines.map(line => `<p class="text-sm">${line}</p>`).join('')}</div>`;
                    }
                    return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3><p class="text-2xl font-bold">${metric.value}</p><p class="text-xs text-gray-500 mt-1">${metric.note}</p></div>`;
                }).join('');

                const keyMetricsHTML = estate.keyMetrics.map(metric => `
                    <div class="flex items-center space-x-3 bg-gray-50 p-3 rounded-lg">
                        <div class="bg-gray-100 p-2 rounded-full">${metric.icon}</div>
                        <div><p class="text-sm text-gray-500">${metric.label}</p><p class="font-bold text-lg">${metric.value}</p></div>
                    </div>`).join('');

                const observationsHTML = estate.observations.map(obs => `<li class="ml-4">${obs}</li>`).join('');

                return `
                    <div class="bg-white p-6 rounded-lg shadow-lg animate-fade-in">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900">${estate.name}</h2>
                        <p class="text-sm text-gray-500 mb-6 italic">${estate.reportInfo}</p>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-8">${summaryMetricsHTML}</div>
                        
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-4 border-b pb-2">Key Metrics & Agronomic Status</h3><div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-4">${keyMetricsHTML}</div></div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <div><h3 class="text-xl font-semibold mb-2">Monthly Production vs Rainfall</h3><div class="chart-container"><canvas id="prodChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.production.note}</p></div>
                            <div><h3 class="text-xl font-semibold mb-2">Palm Age Profile</h3><div class="pie-chart-container"><canvas id="ageChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.ageProfile.note}</p></div>
                        </div>
                        
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-2 border-b pb-2">Key Observations & Issues</h3><ul class="list-disc list-inside space-y-2 text-gray-700 mt-4">${observationsHTML}</ul></div>
                        
                        <div class="mb-8 text-center"><button class="policy-modal-btn bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition shadow-md">View Agricultural Policy Cross-Reference</button></div>
                        
                        <div class="space-y-2">
                            <button data-dropdown-id="${estate.id}-agronomy" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Agronomy Report Details</button>
                            <div id="${estate.id}-agronomy" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                            <button data-dropdown-id="${estate.id}-plantation" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Plantation Advisory Report Details</button>
                            <div id="${estate.id}-plantation" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                        </div>
                    </div>`;
            }

            /**
             * Initializes charts for the estate.
             */
            function initializeChartsForEstate() {
                const prodCanvasId = `prodChart-${estateData.id}`;
                const ageCanvasId = `ageChart-${estateData.id}`;
                
                if (chartInstances[prodCanvasId]) chartInstances[prodCanvasId].destroy();
                if (chartInstances[ageCanvasId]) chartInstances[ageCanvasId].destroy();

                const prodCtx = document.getElementById(prodCanvasId)?.getContext('2d');
                if(prodCtx) {
                    chartInstances[prodCanvasId] = new Chart(prodCtx, {
                        type: 'bar',
                        data: {
                            labels: estateData.chartData.production.labels,
                            datasets: [
                                { label: 'FFB Production (MT)', data: estateData.chartData.production.ffb, type: 'line', borderColor: '#c026d3', backgroundColor: 'transparent', yAxisID: 'y-ffb', tension: 0.4 },
                                { label: 'Rainfall (mm)', data: estateData.chartData.production.rainfall, backgroundColor: '#3b82f6', yAxisID: 'y-rainfall' }
                            ]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { x: { grid: { display: false } }, 'y-ffb': { type: 'linear', position: 'left', title: { display: true, text: 'FFB Production (MT)' } }, 'y-rainfall': { type: 'linear', position: 'right', title: { display: true, text: 'Rainfall (mm)' }, grid: { drawOnChartArea: false } } } }
                    });
                }

                const ageCtx = document.getElementById(ageCanvasId)?.getContext('2d');
                if(ageCtx) {
                    chartInstances[ageCanvasId] = new Chart(ageCtx, {
                        type: 'pie',
                        data: {
                            labels: estateData.chartData.ageProfile.labels,
                            datasets: [{ data: estateData.chartData.ageProfile.data, backgroundColor: ['#4CAF50', '#2196F3', '#FFC107', '#F44336', '#9C27B0'], hoverOffset: 4 }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: estateData.chartData.ageProfile.title, font: { size: 16 } }, legend: { position: 'right' } } }
                    });
                }
            }
            
            /**
             * Populates the content of the collapsible report sections.
             */
            function populateInternalDropdowns() {
                const agronomyDiv = document.getElementById(`${estateData.id}-agronomy`);
                const plantationDiv = document.getElementById(`${estateData.id}-plantation`);

                if (agronomyDiv && estateData.reports.agronomy) {
                    agronomyDiv.innerHTML = Object.entries(estateData.reports.agronomy)
                        .map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                }
                if (plantationDiv && estateData.reports.plantation) {
                    plantationDiv.innerHTML = Object.entries(estateData.reports.plantation)
                        .map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                }
            }

            /**
             * Attaches event listeners for dropdowns and modal buttons.
             */
            function attachEventListeners() {
                container.querySelectorAll('.dropdown-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.dropdownId;
                        const content = document.getElementById(id);
                        const isActive = content.classList.toggle('active');
                        event.currentTarget.classList.toggle('active', isActive);
                    });
                });

                container.querySelector('.policy-modal-btn')?.addEventListener('click', () => {
                    openPolicyModal();
                });
            }


            // --- INITIALIZATION ---
            renderEstate();
        });
        
        /**
         * Opens the policy modal with data from the estate.
         */
        function openPolicyModal() {
            const estateData = {"id":"psk","name":"PSK Estate","reportInfo":"Data based on Agronomy & PA Reports (June 2024 - March 2025).","summaryMetrics":{"area":{"title":"Estate Area","lines":["Mature: 1,999.83 ha","Immature: 0.00 ha","Total: 1,999.83 ha"]},"yield":{"title":"Yield/Ha (Actual vs Budget)","value":"6.17 / 7.91 MT","note":"For 6 months (Jan-Jun 2024)"},"cost":{"title":"FFB Cost/Tonne (Actual vs Budget)","value":"RM 251.99 / RM 417.95","note":"Ex-Estate, 6 months"},"weeding":{"title":"Weeding Progress","value":"49%","note":"Overall, as of Jun 2024"},"manuring":{"title":"Manuring Progress","value":"31%","note":"Overall, as of Jun 2024"}},"keyMetrics":[{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-blue-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z' /></svg>","label":"Labour Ratio","value":"1:29 ha (Harvester)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-green-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' /></svg>","label":"P&D Status","value":"Action Required (Rats)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-yellow-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 10V3L4 14h7v7l9-11h-7z' /></svg>","label":"OER %","value":"16.11% (Actual)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z' /></svg>","label":"Harvester Prod.","value":"1.8 MT/md (Low)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-purple-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z' /></svg>","label":"Harvest Interval","value":"19 days (Average)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-teal-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17.657 18.343A8 8 0 016.343 7.029m11.314 11.314a8 8 0 01-11.314-11.314m2.121 13.435a2 2 0 01-2.828 0l-2.122-2.121a2 2 0 010-2.828l5.656-5.657a2 2 0 012.829 0l2.121 2.121a2 2 0 010 2.828l-5.657 5.657z' /></svg>","label":"Nutrient Status","value":"Suboptimal (Mg Deficiency)"}],"chartData":{"production":{"labels":["Jan-24","Feb-24","Mar-24","Apr-24","May-24","Jun-24","Jul-24","Aug-24","Sep-24","Oct-24","Nov-24","Dec-24"],"ffb":[1800,2000,2500,2800,3200,3500,3000,2900,2700,2500,2300,2100],"rainfall":[1485,51,103,153,85,180,75,128,187.5,321,554,448],"note":"*FFB production data for July-Dec 2024 is estimated based on reported trends."},"ageProfile":{"labels":["0-3 Years","4-7 Years","8-19 Years","20-25 Years",">26 Years"],"data":[0,10,60,30,0],"title":"PSK Estate Palm Age Distribution","note":"*Hypothetical age distribution focusing on prime age."}},"observations":["<b>Harvester Shortage & Low Productivity:</b> Critical shortage of harvesters and low output, leading to extended harvesting intervals and crop loss. (PA Report, Pg. 51; Agronomy Report, Pg. 48)","<b>Delayed Manuring Program:</b> Significant delays in fertilizer application in 2024 and slow progress in 2025, impacting yield potential and palm health. (PA Report, Pg. 51; Agronomy Report, Pg. 11-13)","<b>Backlog Pruning & Poor Canopy Management:</b> Pruning program significantly behind schedule, resulting in under-pruned palms and hindering harvesting efficiency. (PA Report, Pg. 52; Agronomy Report, Pg. 25-26)","<b>High Rat Damage:</b> Significant rat infestation (over 10% in many blocks) with insufficient baiting and poor barn owl box maintenance. (PA Report, Pg. 52; Agronomy Report, Pg. 43-44)"],"reports":{"agronomy":{"Executive Summary":"Palm census is progressing slower than expected. The manuring program for 2024 was incomplete and 2025 progress is slow. Crop recovery is unsatisfactory due to prolonged harvesting intervals and incomplete loose fruit collection, leading to significant over-ripe bunches. Palm nutrient status is suboptimal, and pruning remains a major issue. Weed control is slow, and rat infestation is high with insufficient baiting.","Nutrient Inputs/Progress of Manuring":"Only 67% of the 2024 manuring program was completed due to flooding and late deliveries (Agronomy Report, Pg. 11). As of March 2025, only 5% of the first half's program is complete. The fertilizer store has a leaking roof, risking quality (Agronomy Report, Pg. 13). Expediting application is crucial.","Agronomic Observation":"Harvesting intervals exceeded 15 days in 2024, leading to poor crop recovery and over-ripe/rotten bunches (Agronomy Report, Pg. 25). Palm appearance is unsatisfactory, especially in peat soil areas, with yellowing and premature frond snapping. Pruning is significantly behind schedule (only 1% completed in Feb 2025). Weed control is slow, with undesirable grasses and broadleaf weeds present. High rat damage (over 10% in many blocks) with insufficient baiting and poor barn owl box maintenance (Agronomy Report, Pg. 43).","Yield Performance":"Yield in 2024 increased by 1% compared to the previous year but remains below the regional trend. For Jan-Feb 2025, yield improved by 22% compared to last year, though PM05C and PM05D declined. Low production is due to extended harvesting intervals (65% of target rounds achieved) and harvester shortage (1.10-1.40 MT/md productivity). Incomplete fertilizer programs and low average bunch weight (11.05 kg) are also limiting factors (Agronomy Report, Pg. 48).","Fertilizer Recommendation":"No amendments to the 2025 fertilizer program. The estate is advised to expedite application immediately after the rainy season and ensure proper drainage to prevent waterlogging."},"plantation":{"Executive Summary":"PSK Estate is facing a critical shortage of harvesters and sprayers, leading to high turnover due to low wages. The manuring program is significantly delayed, and there's a substantial backlog in pruning. Harvester productivity is low, and the Vehicle Running Account records require immediate correction.","Area Statement":"The total mature planted area is 1,999.83 ha, with 0.00 ha immature. There has been no change in the area statement, and no replanting is scheduled for 2025.","Labour Statement":"There is a critical shortage of 12 harvesters (actual ratio 1:29 ha vs 1:25 ha required) and 4 sprayers. High turnover is attributed to low harvesting rates. 16 out of 23 new recruits left the estate (PA Report, Pg. 51)."}},"policy":" <div class='policy-item'><p class='font-semibold'>Harvester Productivity & Crop Recovery</p><p class='text-sm text-gray-600'><b>Policy 12.6:</b> Maintain high harvesting standards; collect all loose fruits. (Pg. 128)</p><p class='text-sm text-gray-600'><b>Policy 12.3:</b> Ideal harvesting interval 10-12 days. (Pg. 127)</p></div> <div class='policy-item'><p class='font-semibold'>Delayed Manuring Program</p><p class='text-sm text-gray-600'><b>Policy 8.4.1 A:</b> Ensure timely fertilizer application, avoiding heavy/low rainfall periods; proper planning. (Pg. 82-83)</p></div> <div class='policy-item'><p class='font-semibold'>Pruning Backlog & Canopy Management</p><p class='text-sm text-gray-600'><b>Policy 11.01:</b> Pruning is for practical purposes; avoid over-pruning. (Pg. 124)</p><p class='text-sm text-gray-600'><b>Policy 11.1.2 a:</b> Retain two fronds below lowest bunches. (Pg. 124)</p><p class='text-sm text-gray-600'><b>Policy 11.3:</b> Stack pruned fronds neatly in inter-lines. (Pg. 125)</p></div> <div class='policy-item'><p class='font-semibold'>High Rat Damage</p><p class='text-sm text-gray-600'><b>Policy 9.1.3 iii:</b> Conduct regular rat baiting if damage >5%. (Pg. 118)</p><p class='text-sm text-gray-600'><b>Policy 9.1.3 i:</b> Encourage barn owls; use warfarin baits if needed. (Pg. 120)</p></div>"};
            document.getElementById('modalTitle').innerText = `Agricultural Policy Cross-Reference: ${estateData.name}`;
            document.getElementById('modalContent').innerHTML = estateData.policy;
            document.getElementById('policyModal').classList.add('active');
        }

        /**
         * Closes the policy modal.
         */
        function closePolicyModal() {
            document.getElementById('policyModal').classList.remove('active');
        }
    </script>
</body>
</html>
