<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ladang Darabif & Insan Jaya - Plantation and Agronomy Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .details-content { display: none; }
        .details-content.active { display: block; }
        .dropdown-btn.active { background-color: #4a5568; }
        .policy-item { border-left: 3px solid #6366f1; padding-left: 1rem; margin-top: 0.75rem; }
        .modal { display: none; }
        .modal.active { display: flex; }
        .chart-container { position: relative; height: 300px; width: 100%; margin: auto; }
        .pie-chart-container { position: relative; height: 350px; width: 100%; margin: auto; }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-md">
        <nav class="container mx-auto px-6 py-4 flex items-center justify-between">
            <div class="text-xl font-bold text-gray-900">
                <a href="index.html" class="flex items-center">
                    Ladang Darabif & Insan Jaya Report
                </a>
            </div>
            <a href="estates.html" class="text-indigo-600 hover:text-indigo-800 transition duration-300">&larr; Back to Estates List</a>
        </nav>
    </header>

    <!-- Main container for the report -->
    <div class="container mx-auto p-4 md:p-8">
        <div id="selected-estate-container" class="grid grid-cols-1 gap-8">
             <!-- Content will be generated by JavaScript -->
        </div>
    </div>
    
    <!-- Modal for displaying policy details -->
    <div id="policyModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-2xl font-bold">Agricultural Policy Cross-Reference</h3>
                <button onclick="closePolicyModal()" class="text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
            </div>
            <div id="modalContent" class="space-y-4 overflow-y-auto pr-4 flex-grow">
                <!-- Modal content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Main script for application logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA STORE ---
            const estateData = {"id":"darabif","name":"Ladang Darabif & Insan Jaya Estate","reportInfo":"Data based on Agronomy Report 1-2025 (Feb 2025).","summaryMetrics":{"area":{"title":"Estate Area","lines":["Ladang Insan Jaya: 483.00 ha Mature","Ladang Darabif: 1,647.00 ha Mature","Total: 2,130.00 ha"]},"yield":{"title":"Yield/Ha (Actual 2024)","value":"19.34 MT","note":"Combined Average"},"cost":{"title":"FFB Cost/Tonne","value":"N/A","note":"Data not available"},"weeding":{"title":"Weeding Progress","value":"Circle: Behind Schedule","note":"For 2025 First Round (as of Feb)"},"manuring":{"title":"Manuring Progress","value":"10% (Avg)","note":"As of Feb 2025"}},"keyMetrics":[{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-blue-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z' /></svg>","label":"Labour Ratio","value":"N/A"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-green-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' /></svg>","label":"P&D Status","value":"Minimal Rat, Ganoderma Monitored"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-yellow-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 10V3L4 14h7v7l9-11h-7z' /></svg>","label":"OER %","value":"N/A"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z' /></svg>","label":"Harvester Prod.","value":"Low (Extended Intervals)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-purple-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z' /></svg>","label":"Harvest Interval","value":"Extended (>20 days)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-teal-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17.657 18.343A8 8 0 016.343 7.029m11.314 11.314a8 8 0 01-11.314-11.314m2.121 13.435a2 2 0 01-2.828 0l-2.122-2.121a2 2 0 010-2.828l5.656-5.657a2 2 0 012.829 0l2.121 2.121a2 2 0 010 2.828l-5.657 5.657z' /></svg>","label":"Nutrient Status","value":"Some areas less vigor"}],"chartData":{"production":{"labels":["Jan-24","Feb-24","Mar-24","Apr-24","May-24","Jun-24","Jul-24","Aug-24","Sep-24","Oct-24","Nov-24","Dec-24"],"ffb":[3100,3900,3450,3400,4800,4550,4450,4650,4950,4400,3600,3300],"rainfall":[607,32,60,95,111,88,34,139,120,358,449,0],"note":"*Combined FFB production and average rainfall for 2024."},"ageProfile":{"labels":["8-19 Years","20-25 Years"],"data":[14.5,85.5],"title":"Darabif & Insan Jaya Palm Age Distribution","note":"*Combined weighted age distribution for 2025."}},"observations":["<b>Unupdated Palm Census:</b> Palm census data has not been updated since 2019 for both estates. (Agronomy Report, Pg. 4, 10)","<b>Manuring Delays & Quality:</b> Significant delays in 2024 and slow progress in 2025 manuring programs, with suboptimal application quality. (Agronomy Report, Pg. 4, 12, 13, 14, 16)","<b>Extended Harvesting Intervals & Crop Quality:</b> Most blocks experience harvesting intervals exceeding 20 days, leading to over-ripe/rotten bunches and FFB left overnight, impacting crop recovery. (Agronomy Report, Pg. 5, 17, 18, 36, 37)","<b>Pruning Issues:</b> Under-pruning and inconsistent frond stacking observed, hindering efficiency and loose fruit collection. Pre-matured frond snapping also noted. (Agronomy Report, Pg. 5, 24, 25, 41, 42, 43)","<b>Weed Control Challenges:</b> Circle spraying is behind schedule, and undesirable weeds are present. (Agronomy Report, Pg. 5, 29, 30, 31, 45, 46, 47)","<b>Yield Decline (2025):</b> Jan-Feb 2025 cumulative yields are significantly lower (-23% / -19%) compared to last year due to seasonal factors. (Agronomy Report, Pg. 6, 51, 52)","<b>Poor Road Conditions:</b> Road maintenance is a concern, especially during rainy periods, hindering smooth crop evacuation. (Agronomy Report, Pg. 6, 42, 54)"],"reports":{"agronomy":{"Executive Summary":"Palm census data has not been updated since 2019. Manuring programs experienced delays, and application quality needs improvement. Harvesting intervals are extended, leading to inconsistent crop quality and over-ripe bunches, though loose fruit collection has improved. Canopy management is generally acceptable, but under-pruning and inconsistent frond stacking were observed. Weeding programs are slightly delayed, with undesirable weeds present and some over-spraying. Rat infestation is minimal, and Ganoderma infection is being monitored. Yield performance for Jan-Feb 2025 is significantly lower due to seasonal factors, and road conditions are a concern for crop evacuation. Fertilizer recommendations remain unchanged.","Nutrient Inputs/Progress of Manuring":"The 2024 manuring program was completed for Ladang Darabif, and 97% completed for Ladang Insan Jaya due to adverse weather and labor shortage. Delays of 3-5 months were observed in 2024. For 2025, Ladang Darabif is 17% complete and Ladang Insan Jaya is 8% complete as of Feb 2025, progressing slower than expected. Fertilizer delivery is also slower than scheduled. Application quality needs improvement (narrow and lumpy application observed). The fertilizer store is acceptable.","Agronomic Observations (Ladang Insan Jaya)":"Harvesting intervals are mostly exceeding 20 days (e.g., PM03C: 23 days, PM14F: 22-28 days, PM15G: 24-27 days), leading to significant over-ripe and rotten bunches (P15G-01, P15G-02). FFB were left overnight in P15G-04. Loose fruit collection is generally acceptable but oxidized loose fruit found in hilly areas. Palm appearance is acceptable, but retarded growth and small bunch formation observed in laterite areas and areas previously overgrown by weeds (P15G-03). Pruning is progressing well in 2025, but under-pruning was observed in PM03C-01. Pre-mature frond snapping in PM05E-01 and PM05E-02. Frond heap management is inconsistent. Weeding program is behind schedule for circle spraying, with over-spraying in E02 and G01. Undesirable weeds (Giant Paspalum, Clidemia hirta, Bamboo, woody vegetation, Stenochlaena, Bracken ferns, VOPs) are present. Rat damage is minimal, but a full census is needed. Ganoderma symptoms (frond snapping, fallen palms) in E01, requiring deboling. No leaf-eating pest infestations.","Agronomic Observations (Ladang Darabif)":"Harvesting intervals are extended in most blocks (e.g., PM03A: 20-39 days, PM03B: 19-28 days). Crop quality is unsatisfactory with under-ripe and significant over-ripe/unfresh bunches observed. Palm appearance is generally acceptable, but less vigor in flood-prone D3. Pruning progress for 2025 is not yet reported (as of Feb), with slight under-pruning in C01, A02, D02, and pre-matured frond snapping in A1, D1. Inconsistent frond stacking in D1, A3. Roadside pruning is needed in D1 due to poor road conditions. Inter-row spraying is progressing well, but circle weeding is slower than expected. VOPs and Epiphytes need eradication. Rat infestation is minimal, but a new census is needed. Ganoderma infection remains under control, but new fallen palms need deboling.","Yield Performance":"Yields in 2024 were significantly higher than the previous year for both estates (Darabif: 18.61 MT/ha vs 23.64 MT/ha in 2023; Insan Jaya: 20.06 MT/ha vs 22.34 MT/ha in 2023). However, crop recovery was not maximized due to less than 24 harvesting rounds (Darabif: 18.08, Insan Jaya: 20.46). For Jan-Feb 2025, cumulative yields declined significantly (Darabif -23%, Insan Jaya -19%) due to seasonal factors. Insan Jaya's current yield is unsatisfactory despite 64% prime-age palms. Road maintenance is a concern for crop evacuation.","Fertilizer Recommendation":"The 2025 fertilizer program remains unchanged. The 2026 program will be developed after the next agronomy report."},"plantation":{"Report Status":"The Plantation Advisory Report for Ladang Darabif & Insan Jaya Estate is not yet available. Please check back later for updates."}},"policy":" <div class='policy-item'><p class='font-semibold'>Palm Census Update</p><p class='text-sm text-gray-600'><b>Policy 1.0:</b> Please update the palm census data. (Pg. 4)</p></div> <div class='policy-item'><p class='font-semibold'>Manuring Delays & Quality</p><p class='text-sm text-gray-600'><b>Policy 8.4.1 A:</b> Progress of manuring has been unsatisfactory, and the quality of fertilizer application is suboptimal. Your immediate action is required. (Pg. 4)</p><p class='text-sm text-gray-600'><b>Policy 8.5.1:</b> Fertilizer placement at the side of the frond heap should only be considered for blocks with proper frond stacking. (Pg. 4)</p><p class='text-sm text-gray-600'><b>Policy 8.4.1 A:</b> You are required to correct the following shortcomings: Delays in fertilizer application. (Pg. 4)</p><p class='text-sm text-gray-600'><b>Policy 8.4.1 A:</b> The estate is advised not to delay the manuring application beyond the scheduled timeline, especially for prime mature palms. (Pg. 14)</p></div> <div class='policy-item'><p class='font-semibold'>Harvesting Interval & Crop Recovery</p><p class='text-sm text-gray-600'><b>Policy 12.3:</b> You must shorten harvesting intervals to 15 days or less and improve the quality of loose fruit collection. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 12.4.1:</b> Crop recovery requires attention for improvement. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 12.6:</b> To maintain crop quality, it is advised to avoid leaving freshly cut bunches at the platform for an extended period and ensure timely evacuation. (Pg. 18)</p></div> <div class='policy-item'><p class='font-semibold'>Palm Appearance & Nutrient Status</p><p class='text-sm text-gray-600'><b>Policy 8.3.1:</b> Suboptimal palm nutrient status in subblocks must be corrected through proper manuring inputs. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 8.8.1.2:</b> It is recommended to carry out mulching of empty fruit bunches at 40mt/ha in laterite areas, as the by-product helps to ameliorate the soil conditions. (Pg. 21)</p></div> <div class='policy-item'><p class='font-semibold'>Pruning Regime & Canopy Management</p><p class='text-sm text-gray-600'><b>Policy 11.01:</b> Canopy management is deemed acceptable, though further improvement is necessary. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 11.1.2:</b> It is advised to expedite pruning process, as delayed pruning may lead to increased workload and inefficiencies in harvesting. (Pg. 41)</p><p class='text-sm text-gray-600'><b>Policy 11.1.2:</b> The estate is advised to closely monitor pruning activities, ensuring that only dried fronds are removed while avoiding over-pruning. (Pg. 41)</p><p class='text-sm text-gray-600'><b>Policy 11.3:</b> Inconsistent frond stacking needs to be addressed. (Pg. 5)</p></div> <div class='policy-item'><p class='font-semibold'>Weed Control</p><p class='text-sm text-gray-600'><b>Policy 6.01:</b> The overall field vegetation is acceptable. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 6.2 ii:</b> The quality of spraying must be improved to maintain beneficial ground cover while effectively controlling weeds. (Pg. 29)</p><p class='text-sm text-gray-600'><b>Policy 6.1 ii:</b> Volunteer Oil Palms (VOPs) were present at low levels but should be addressed promptly to prevent further spread and competition with palms. (Pg. 30)</p><p class='text-sm text-gray-600'><b>Policy 6.2 i:</b> It is recommended to expedite the circle spraying process to ensure optimal field conditions. (Pg. 31)</p></div> <div class='policy-item'><p class='font-semibold'>Pest and Disease Control</p><p class='text-sm text-gray-600'><b>Policy 9.1.3:</b> Rat infestation is currently under control, while Ganoderma infection remains insignificant. (Pg. 6)</p><p class='text-sm text-gray-600'><b>Policy 9.3:</b> Ganoderma census is to be carried out at yearly basis, and deboling should be continued wherever detected. (Pg. 6)</p></div> <div class='policy-item'><p class='font-semibold'>Road Conditions</p><p class='text-sm text-gray-600'><b>Policy 10.01:</b> Road maintenance is another concern. The estate has to ensure that both main and field roads are properly maintained for smooth crop evacuation. (Pg. 54)</p><p class='text-sm text-gray-600'><b>Policy 10.1.2:</b> It is recommended to implement proper roadside pruning. This will improve sunlight exposure, facilitating faster road drying. (Pg. 42)</p></div>"};

            let chartInstances = {};
            const container = document.getElementById('selected-estate-container');

            function renderEstate() {
                container.innerHTML = createEstateHTML(estateData);
                setTimeout(() => {
                    initializeChartsForEstate();
                    populateInternalDropdowns();
                    attachEventListeners();
                }, 0);
            }

            function createEstateHTML(estate) {
                const summaryMetricsHTML = Object.values(estate.summaryMetrics).map(metric => {
                    const colorClass = metric.title.includes('Area') ? 'bg-blue-50 text-blue-800' : 
                                       metric.title.includes('Yield') ? 'bg-green-50 text-green-800' :
                                       metric.title.includes('Cost') ? 'bg-red-50 text-red-800' :
                                       metric.title.includes('Weeding') ? 'bg-yellow-50 text-yellow-800' : 'bg-purple-50 text-purple-800';
                    if (metric.lines) {
                        return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3>${metric.lines.map(line => `<p class="text-sm">${line}</p>`).join('')}</div>`;
                    }
                    return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3><p class="text-2xl font-bold">${metric.value}</p><p class="text-xs text-gray-500 mt-1">${metric.note}</p></div>`;
                }).join('');

                const keyMetricsHTML = estate.keyMetrics.map(metric => `
                    <div class="flex items-center space-x-3 bg-gray-50 p-3 rounded-lg">
                        <div class="bg-gray-100 p-2 rounded-full">${metric.icon}</div>
                        <div><p class="text-sm text-gray-500">${metric.label}</p><p class="font-bold text-lg">${metric.value}</p></div>
                    </div>`).join('');

                const observationsHTML = estate.observations.map(obs => `<li class="ml-4">${obs}</li>`).join('');

                return `
                    <div class="bg-white p-6 rounded-lg shadow-lg animate-fade-in">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900">${estate.name}</h2>
                        <p class="text-sm text-gray-500 mb-6 italic">${estate.reportInfo}</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-8">${summaryMetricsHTML}</div>
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-4 border-b pb-2">Key Metrics & Agronomic Status</h3><div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-4">${keyMetricsHTML}</div></div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <div><h3 class="text-xl font-semibold mb-2">Monthly Production vs Rainfall</h3><div class="chart-container"><canvas id="prodChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.production.note}</p></div>
                            <div><h3 class="text-xl font-semibold mb-2">Palm Age Profile</h3><div class="pie-chart-container"><canvas id="ageChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.ageProfile.note}</p></div>
                        </div>
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-2 border-b pb-2">Key Observations & Issues</h3><ul class="list-disc list-inside space-y-2 text-gray-700 mt-4">${observationsHTML}</ul></div>
                        <div class="mb-8 text-center"><button class="policy-modal-btn bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition shadow-md">View Agricultural Policy Cross-Reference</button></div>
                        <div class="space-y-2">
                            <button data-dropdown-id="${estate.id}-agronomy" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Agronomy Report Details</button>
                            <div id="${estate.id}-agronomy" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                            <button data-dropdown-id="${estate.id}-plantation" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Plantation Advisory Report Details</button>
                            <div id="${estate.id}-plantation" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                        </div>
                    </div>`;
            }

            function initializeChartsForEstate() {
                const prodCanvasId = `prodChart-${estateData.id}`;
                const ageCanvasId = `ageChart-${estateData.id}`;
                if (chartInstances[prodCanvasId]) chartInstances[prodCanvasId].destroy();
                if (chartInstances[ageCanvasId]) chartInstances[ageCanvasId].destroy();

                const prodCtx = document.getElementById(prodCanvasId)?.getContext('2d');
                if(prodCtx) {
                    chartInstances[prodCanvasId] = new Chart(prodCtx, {
                        type: 'bar',
                        data: {
                            labels: estateData.chartData.production.labels,
                            datasets: [
                                { label: 'FFB Production (MT)', data: estateData.chartData.production.ffb, type: 'line', borderColor: '#c026d3', backgroundColor: 'transparent', yAxisID: 'y-ffb', tension: 0.4 },
                                { label: 'Rainfall (mm)', data: estateData.chartData.production.rainfall, backgroundColor: '#3b82f6', yAxisID: 'y-rainfall' }
                            ]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { x: { grid: { display: false } }, 'y-ffb': { type: 'linear', position: 'left', title: { display: true, text: 'FFB Production (MT)' } }, 'y-rainfall': { type: 'linear', position: 'right', title: { display: true, text: 'Rainfall (mm)' }, grid: { drawOnChartArea: false } } } }
                    });
                }

                const ageCtx = document.getElementById(ageCanvasId)?.getContext('2d');
                if(ageCtx) {
                    chartInstances[ageCanvasId] = new Chart(ageCtx, {
                        type: 'pie',
                        data: {
                            labels: estateData.chartData.ageProfile.labels,
                            datasets: [{ data: estateData.chartData.ageProfile.data, backgroundColor: ['#4CAF50', '#2196F3', '#FFC107', '#F44336', '#9C27B0'], hoverOffset: 4 }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: estateData.chartData.ageProfile.title, font: { size: 16 } }, legend: { position: 'right' } } }
                    });
                }
            }
            
            function populateInternalDropdowns() {
                const agronomyDiv = document.getElementById(`${estateData.id}-agronomy`);
                const plantationDiv = document.getElementById(`${estateData.id}-plantation`);
                if (agronomyDiv && estateData.reports.agronomy) {
                    agronomyDiv.innerHTML = Object.entries(estateData.reports.agronomy).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                }
                if (plantationDiv && estateData.reports.plantation) {
                    plantationDiv.innerHTML = Object.entries(estateData.reports.plantation).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                }
            }

            function attachEventListeners() {
                container.querySelectorAll('.dropdown-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.dropdownId;
                        const content = document.getElementById(id);
                        content.classList.toggle('active');
                        event.currentTarget.classList.toggle('active');
                    });
                });
                container.querySelector('.policy-modal-btn')?.addEventListener('click', openPolicyModal);
            }

            renderEstate();
        });
        
        function openPolicyModal() {
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            const estateData = {"id":"darabif","name":"Ladang Darabif & Insan Jaya Estate","reportInfo":"Data based on Agronomy Report 1-2025 (Feb 2025).","summaryMetrics":{"area":{"title":"Estate Area","lines":["Ladang Insan Jaya: 483.00 ha Mature","Ladang Darabif: 1,647.00 ha Mature","Total: 2,130.00 ha"]},"yield":{"title":"Yield/Ha (Actual 2024)","value":"19.34 MT","note":"Combined Average"},"cost":{"title":"FFB Cost/Tonne","value":"N/A","note":"Data not available"},"weeding":{"title":"Weeding Progress","value":"Circle: Behind Schedule","note":"For 2025 First Round (as of Feb)"},"manuring":{"title":"Manuring Progress","value":"10% (Avg)","note":"As of Feb 2025"}},"keyMetrics":[{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-blue-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z' /></svg>","label":"Labour Ratio","value":"N/A"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-green-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' /></svg>","label":"P&D Status","value":"Minimal Rat, Ganoderma Monitored"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-yellow-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 10V3L4 14h7v7l9-11h-7z' /></svg>","label":"OER %","value":"N/A"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z' /></svg>","label":"Harvester Prod.","value":"Low (Extended Intervals)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-purple-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z' /></svg>","label":"Harvest Interval","value":"Extended (>20 days)"},{"icon":"<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-teal-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17.657 18.343A8 8 0 016.343 7.029m11.314 11.314a8 8 0 01-11.314-11.314m2.121 13.435a2 2 0 01-2.828 0l-2.122-2.121a2 2 0 010-2.828l5.656-5.657a2 2 0 012.829 0l2.121 2.121a2 2 0 010 2.828l-5.657 5.657z' /></svg>","label":"Nutrient Status","value":"Some areas less vigor"}],"chartData":{"production":{"labels":["Jan-24","Feb-24","Mar-24","Apr-24","May-24","Jun-24","Jul-24","Aug-24","Sep-24","Oct-24","Nov-24","Dec-24"],"ffb":[3100,3900,3450,3400,4800,4550,4450,4650,4950,4400,3600,3300],"rainfall":[607,32,60,95,111,88,34,139,120,358,449,0],"note":"*Combined FFB production and average rainfall for 2024."},"ageProfile":{"labels":["8-19 Years","20-25 Years"],"data":[14.5,85.5],"title":"Darabif & Insan Jaya Palm Age Distribution","note":"*Combined weighted age distribution for 2025."}},"observations":["<b>Unupdated Palm Census:</b> Palm census data has not been updated since 2019 for both estates. (Agronomy Report, Pg. 4, 10)","<b>Manuring Delays & Quality:</b> Significant delays in 2024 and slow progress in 2025 manuring programs, with suboptimal application quality. (Agronomy Report, Pg. 4, 12, 13, 14, 16)","<b>Extended Harvesting Intervals & Crop Quality:</b> Most blocks experience harvesting intervals exceeding 20 days, leading to over-ripe/rotten bunches and FFB left overnight, impacting crop recovery. (Agronomy Report, Pg. 5, 17, 18, 36, 37)","<b>Pruning Issues:</b> Under-pruning and inconsistent frond stacking observed, hindering efficiency and loose fruit collection. Pre-matured frond snapping also noted. (Agronomy Report, Pg. 5, 24, 25, 41, 42, 43)","<b>Weed Control Challenges:</b> Circle spraying is behind schedule, and undesirable weeds are present. (Agronomy Report, Pg. 5, 29, 30, 31, 45, 46, 47)","<b>Yield Decline (2025):</b> Jan-Feb 2025 cumulative yields are significantly lower (-23% / -19%) compared to last year due to seasonal factors. (Agronomy Report, Pg. 6, 51, 52)","<b>Poor Road Conditions:</b> Road maintenance is a concern, especially during rainy periods, hindering smooth crop evacuation. (Agronomy Report, Pg. 6, 42, 54)"],"reports":{"agronomy":{"Executive Summary":"Palm census data has not been updated since 2019. Manuring programs experienced delays, and application quality needs improvement. Harvesting intervals are extended, leading to inconsistent crop quality and over-ripe bunches, though loose fruit collection has improved. Canopy management is generally acceptable, but under-pruning and inconsistent frond stacking were observed. Weeding programs are slightly delayed, with undesirable weeds present and some over-spraying. Rat infestation is minimal, and Ganoderma infection is being monitored. Yield performance for Jan-Feb 2025 is significantly lower due to seasonal factors, and road conditions are a concern for crop evacuation. Fertilizer recommendations remain unchanged.","Nutrient Inputs/Progress of Manuring":"The 2024 manuring program was completed for Ladang Darabif, and 97% completed for Ladang Insan Jaya due to adverse weather and labor shortage. Delays of 3-5 months were observed in 2024. For 2025, Ladang Darabif is 17% complete and Ladang Insan Jaya is 8% complete as of Feb 2025, progressing slower than expected. Fertilizer delivery is also slower than scheduled. Application quality needs improvement (narrow and lumpy application observed). The fertilizer store is acceptable.","Agronomic Observations (Ladang Insan Jaya)":"Harvesting intervals are mostly exceeding 20 days (e.g., PM03C: 23 days, PM14F: 22-28 days, PM15G: 24-27 days), leading to significant over-ripe and rotten bunches (P15G-01, P15G-02). FFB were left overnight in P15G-04. Loose fruit collection is generally acceptable but oxidized loose fruit found in hilly areas. Palm appearance is acceptable, but retarded growth and small bunch formation observed in laterite areas and areas previously overgrown by weeds (P15G-03). Pruning is progressing well in 2025, but under-pruning was observed in PM03C-01. Pre-mature frond snapping in PM05E-01 and PM05E-02. Frond heap management is inconsistent. Weeding program is behind schedule for circle spraying, with over-spraying in E02 and G01. Undesirable weeds (Giant Paspalum, Clidemia hirta, Bamboo, woody vegetation, Stenochlaena, Bracken ferns, VOPs) are present. Rat damage is minimal, but a full census is needed. Ganoderma symptoms (frond snapping, fallen palms) in E01, requiring deboling. No leaf-eating pest infestations.","Agronomic Observations (Ladang Darabif)":"Harvesting intervals are extended in most blocks (e.g., PM03A: 20-39 days, PM03B: 19-28 days). Crop quality is unsatisfactory with under-ripe and significant over-ripe/unfresh bunches observed. Palm appearance is generally acceptable, but less vigor in flood-prone D3. Pruning progress for 2025 is not yet reported (as of Feb), with slight under-pruning in C01, A02, D02, and pre-matured frond snapping in A1, D1. Inconsistent frond stacking in D1, A3. Roadside pruning is needed in D1 due to poor road conditions. Inter-row spraying is progressing well, but circle weeding is slower than expected. VOPs and Epiphytes need eradication. Rat infestation is minimal, but a new census is needed. Ganoderma infection remains under control, but new fallen palms need deboling.","Yield Performance":"Yields in 2024 were significantly higher than the previous year for both estates (Darabif: 18.61 MT/ha vs 23.64 MT/ha in 2023; Insan Jaya: 20.06 MT/ha vs 22.34 MT/ha in 2023). However, crop recovery was not maximized due to less than 24 harvesting rounds (Darabif: 18.08, Insan Jaya: 20.46). For Jan-Feb 2025, cumulative yields declined significantly (Darabif -23%, Insan Jaya -19%) due to seasonal factors. Insan Jaya's current yield is unsatisfactory despite 64% prime-age palms. Road maintenance is a concern for crop evacuation.","Fertilizer Recommendation":"The 2025 fertilizer program remains unchanged. The 2026 program will be developed after the next agronomy report."},"plantation":{"Report Status":"The Plantation Advisory Report for Ladang Darabif & Insan Jaya Estate is not yet available. Please check back later for updates."}},"policy":" <div class='policy-item'><p class='font-semibold'>Palm Census Update</p><p class='text-sm text-gray-600'><b>Policy 1.0:</b> Please update the palm census data. (Pg. 4)</p></div> <div class='policy-item'><p class='font-semibold'>Manuring Delays & Quality</p><p class='text-sm text-gray-600'><b>Policy 8.4.1 A:</b> Progress of manuring has been unsatisfactory, and the quality of fertilizer application is suboptimal. Your immediate action is required. (Pg. 4)</p><p class='text-sm text-gray-600'><b>Policy 8.5.1:</b> Fertilizer placement at the side of the frond heap should only be considered for blocks with proper frond stacking. (Pg. 4)</p><p class='text-sm text-gray-600'><b>Policy 8.4.1 A:</b> You are required to correct the following shortcomings: Delays in fertilizer application. (Pg. 4)</p><p class='text-sm text-gray-600'><b>Policy 8.4.1 A:</b> The estate is advised not to delay the manuring application beyond the scheduled timeline, especially for prime mature palms. (Pg. 14)</p></div> <div class='policy-item'><p class='font-semibold'>Harvesting Interval & Crop Recovery</p><p class='text-sm text-gray-600'><b>Policy 12.3:</b> You must shorten harvesting intervals to 15 days or less and improve the quality of loose fruit collection. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 12.4.1:</b> Crop recovery requires attention for improvement. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 12.6:</b> To maintain crop quality, it is advised to avoid leaving freshly cut bunches at the platform for an extended period and ensure timely evacuation. (Pg. 18)</p></div> <div class='policy-item'><p class='font-semibold'>Palm Appearance & Nutrient Status</p><p class='text-sm text-gray-600'><b>Policy 8.3.1:</b> Suboptimal palm nutrient status in subblocks must be corrected through proper manuring inputs. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 8.8.1.2:</b> It is recommended to carry out mulching of empty fruit bunches at 40mt/ha in laterite areas, as the by-product helps to ameliorate the soil conditions. (Pg. 21)</p></div> <div class='policy-item'><p class='font-semibold'>Pruning Regime & Canopy Management</p><p class='text-sm text-gray-600'><b>Policy 11.01:</b> Canopy management is deemed acceptable, though further improvement is necessary. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 11.1.2:</b> It is advised to expedite pruning process, as delayed pruning may lead to increased workload and inefficiencies in harvesting. (Pg. 41)</p><p class='text-sm text-gray-600'><b>Policy 11.1.2:</b> The estate is advised to closely monitor pruning activities, ensuring that only dried fronds are removed while avoiding over-pruning. (Pg. 41)</p><p class='text-sm text-gray-600'><b>Policy 11.3:</b> Inconsistent frond stacking needs to be addressed. (Pg. 5)</p></div> <div class='policy-item'><p class='font-semibold'>Weed Control</p><p class='text-sm text-gray-600'><b>Policy 6.01:</b> The overall field vegetation is acceptable. (Pg. 5)</p><p class='text-sm text-gray-600'><b>Policy 6.2 ii:</b> The quality of spraying must be improved to maintain beneficial ground cover while effectively controlling weeds. (Pg. 29)</p><p class='text-sm text-gray-600'><b>Policy 6.1 ii:</b> Volunteer Oil Palms (VOPs) were present at low levels but should be addressed promptly to prevent further spread and competition with palms. (Pg. 30)</p><p class='text-sm text-gray-600'><b>Policy 6.2 i:</b> It is recommended to expedite the circle spraying process to ensure optimal field conditions. (Pg. 31)</p></div> <div class='policy-item'><p class='font-semibold'>Pest and Disease Control</p><p class='text-sm text-gray-600'><b>Policy 9.1.3:</b> Rat infestation is currently under control, while Ganoderma infection remains insignificant. (Pg. 6)</p><p class='text-sm text-gray-600'><b>Policy 9.3:</b> Ganoderma census is to be carried out at yearly basis, and deboling should be continued wherever detected. (Pg. 6)</p></div> <div class='policy-item'><p class='font-semibold'>Road Conditions</p><p class='text-sm text-gray-600'><b>Policy 10.01:</b> Road maintenance is another concern. The estate has to ensure that both main and field roads are properly maintained for smooth crop evacuation. (Pg. 54)</p><p class='text-sm text-gray-600'><b>Policy 10.1.2:</b> It is recommended to implement proper roadside pruning. This will improve sunlight exposure, facilitating faster road drying. (Pg. 42)</p></div>"};
            modalTitle.innerText = `Agricultural Policy Cross-Reference: ${estateData.name}`;
            modalContent.innerHTML = estateData.policy;
            document.getElementById('policyModal').classList.add('active');
        }

        function closePolicyModal() {
            document.getElementById('policyModal').classList.remove('active');
        }
    </script>
</body>
</html>
