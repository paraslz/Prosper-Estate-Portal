<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Ladang Simpai 2 - Plantation and Agronomy Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .details-content { display: none; }
        .details-content.active { display: block; }
        .dropdown-btn.active { background-color: #14532d; }
        .policy-item { border-left: 3px solid #16a34a; padding-left: 1rem; margin-top: 0.75rem; }
        .modal { display: none; }
        .modal.active { display: flex; }
        .chart-container { position: relative; height: 300px; width: 100%; margin: auto; }
        .pie-chart-container { position: relative; height: 350px; width: 100%; margin: auto; }
        .observation-ref { font-size: 0.75rem; color: #57534e; font-style: italic; }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-md">
        <nav class="container mx-auto px-6 py-4 flex items-center justify-between">
            <div class="text-xl font-bold text-gray-900">
                <a href="index.html" class="flex items-center">
                    Ladang Simpai 2 Report
                </a>
            </div>
            <a href="estates.html" class="text-green-800 hover:text-green-900 transition duration-300">&larr; Back to Estates List</a>
        </nav>
    </header>

    <!-- Main container for the report -->
    <div class="container mx-auto p-4 md:p-8">
        <div id="selected-estate-container" class="grid grid-cols-1 gap-8">
             <!-- Content will be generated by JavaScript -->
        </div>
    </div>
    
    <!-- Modal for displaying policy details -->
    <div id="policyModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-2xl font-bold">Agricultural Policy Cross-Reference</h3>
                <button onclick="closePolicyModal()" class="text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
            </div>
            <div id="modalContent" class="space-y-4 overflow-y-auto pr-4 flex-grow">
                <!-- Modal content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Main script for application logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA STORE ---
            const estateData = {
                "id": "simpai2",
                "name": "Ladang Simpai 2",
                "reportInfo": "Data based on PA Report 2/2025 (Visit: 16th Dec 2025) & Agronomy Report 2/2025 (Visit: 13th Nov 2025).",
                "summaryMetrics": {
                    "area": { 
                        "title": "Estate Area", 
                        "lines": [
                            "Total Planted: 1,237.02 ha", 
                            "Mature: 497.50 ha", 
                            "Immature: 656.82 ha",
                            "Replanting (PR25): 82.70 ha"
                        ] 
                    },
                    "yield": { 
                        "title": "Yield/Ha (Actual / Budget)", 
                        "value": "14.67 / 10.02 MT", 
                        "note": "YTD Oct 2025 (+46% Above Budget)" 
                    },
                    "cost": { 
                        "title": "FFB Cost/Tonne (Actual / Budget)", 
                        "value": "RM 425.23 / RM 424.49", 
                        "note": "YTD Oct 2025 (In Line)" 
                    },
                    "weeding": { 
                        "title": "Weeding Progress", 
                        "value": "Behind Schedule", 
                        "note": "Sprayer shortage (Need 9 pax)" 
                    },
                    "manuring": { 
                        "title": "Manuring Progress", 
                        "value": "Completed", 
                        "note": "100% Completed for 2025" 
                    }
                },
                "keyMetrics": [
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z' /></svg>", "label": "Labour Status", "value": "Shortage (Ratio 1:23)" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-green-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' /></svg>", "label": "P&D Status", "value": "Under Control" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-yellow-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 10V3L4 14h7v7l9-11h-7z' /></svg>", "label": "OER %", "value": "15.66%", "note": "YTD Oct 2025" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-red-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z' /></svg>", "label": "Harvest Rounds", "value": "17.4 (Budget 20)" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-purple-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z' /></svg>", "label": "Harvest Interval", "value": "12 Days" },
                    { "icon": "<svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6 text-teal-600' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17.657 18.343A8 8 0 016.343 7.029m11.314 11.314a8 8 0 01-11.314-11.314m2.121 13.435a2 2 0 01-2.828 0l-2.122-2.121a2 2 0 010-2.828l5.656-5.657a2 2 0 012.829 0l2.121 2.121a2 2 0 010 2.828l-5.657 5.657z' /></svg>", "label": "Nutrient Status", "value": "Mg Deficiency (PM20B)" }
                ],
                "chartData": {
                    "production": {
                        "labels": ["2024 YTD", "2025 YTD (Oct)"],
                        "data": [13.91, 14.67],
                        "note": "*YTD Yield (MT/Ha). 2025 Performance is 46% above budget. (Source: PA Report 2/2025)"
                    },
                    "ageProfile": {
                        "labels": ["Mature (P97, P18-21)", "Immature (P22-24)", "Replanting (P25)"],
                        "data": [497.50, 656.82, 82.70],
                        "title": "Ladang Simpai 2 Palm Age Distribution",
                        "note": "*Based on Area Statement PA Report 2/2025."
                    }
                },
                "observations": [
                    "<b>Strong Yield Performance:</b> YTD Oct 2025 yield is 14.67 MT/ha, significantly exceeding the budget of 10.02 MT/ha (+46%). However, harvesting rounds (17.4) are still below the target of 20. <span class='observation-ref'>(PA Report 2/2025, Pg. 29, 32)</span>",
                    "<b>Critical Labor Shortage:</b> The estate faces a shortage of weeders (10 pax) and manurers (4 pax). The overall worker-to-planted area ratio is 1:23 ha, which is inadequate for the high upkeep needs of immature areas. <span class='observation-ref'>(PA Report 2/2025, Pg. 12)</span>",
                    "<b>Immature Area Issues (Weeding):</b> In PR24 (229 ha), selective spraying is unsatisfactory with prevalent Woodies, VOPs, and Lalang. Weeding programs are generally behind schedule due to labor lack. <span class='observation-ref'>(PA Report 2/2025, Pg. 46; AR 2/2025 Pg. 22)</span>",
                    "<b>Flooding in Replanting (PR25):</b> Severe flooding has been observed in the PR25 replanting area. Immediate desilting of the primary drain to the outlet is required to prevent seedling damage. <span class='observation-ref'>(PA Report 2/2025, Pg. 50)</span>",
                    "<b>Nutrient Deficiency:</b> Magnesium deficiency symptoms (yellowing lower fronds) persist in young mature block PM20B, particularly on hilly terraces. <span class='observation-ref'>(AR 2/2025 Pg. 17)</span>",
                    "<b>Manuring Completed:</b> The 2025 manuring program was 100% completed by October (17 rounds applied). <span class='observation-ref'>(PA Report 2/2025, Pg. 23)</span>"
                ],
                "reports": {
                    "agronomy": {
                        "Executive Summary": "The estate has shown improvement in manuring progress, with major fertilizers (Mix B, RP, Kies) 100% completed for 2025. However, the critical shortage of weeders (10 pax deficit) has led to delays in field upkeep. Yield performance improved by 44% compared to 2024 (11.27 MT/ha vs 6.35 MT/ha) but remains below potential due to harvesting delays (rounds < 20). (Source: AR 2/2025, Pg. 4-6, 38)",
                        "Nutrient Inputs/Progress of Manuring": "<b>2025 Program:</b> Mix B (100%), RP (100%), Kies (100%), CPD (98%), CRF (51%). Progress is satisfactory. Application quality is generally acceptable, though circle weeding delays in immature areas need attention to ensure nutrient uptake. (Source: AR 2/2025, Pg. 10-11)",
                        "Agronomic Observation": "<b>Mature (PM971):</b> Harvesting intervals 13-19 days. Pruning generally acceptable but some slight under-pruning noted. Weeding delayed with presence of Clidemia and Asystasia. <br><b>Young Mature (PM18-21):</b> Harvesting intervals acceptable (11-17 days). Crop quality issues (unripe bunches) in PM18A. Magnesium deficiency observed in PM20B (hilly). VOPs present in scattered areas. <br><b>Immature (PR22-24):</b> Weeding delayed; estate is urged to fast-track. Ischaemum muticum present in low-lying areas. Rhinoceros beetle damage is under control (<3%). (Source: AR 2/2025, Pg. 12-34)",
                        "Yield Performance": "Significant improvement YTD Oct 2025 (11.27 MT/ha) vs 2024 (6.35 MT/ha). However, no field met the 20-round target. Young mature areas (PM20B) showed 46% yield increase. (Source: AR 2/2025, Pg. 38)",
                        "Fertilizer Recommendation": "The 2026 fertilizer program has been drawn up and is attached in Appendix 1. Strict adherence is required to maintain the recovery momentum. (Source: AR 2/2025, Pg. 41)"
                    },
                    "plantation": {
                        "Executive Summary": "Crop production is robust at 14.67 MT/ha (+46% above budget). However, management of immature areas is compromised by a severe labor shortage. Recommendations include: 1) Urgent recruitment of sprayers for replanting areas, 2) Adoption of CDA or Inter Pump spraying to boost productivity, 3) Specific eradication of Lalang at PR22 and VOPs/Asystasia at PR23/PR24, and 4) Immediate drainage works to resolve flooding at PR25. (PA Report 2/2025, Pg. 51-52)",
                        "Area Statement": "<b>Total Planted:</b> 1,237.02 ha. <br><b>Mature:</b> 497.50 ha (25.23%). <br><b>Immature:</b> 656.82 ha (33.31%). <br><b>Replanting (PR25):</b> 82.70 ha (6.53%). <br>No replanting is planned for 2026 or 2027. (PA Report 2/2025, Pg. 11)",
                        "Labour Statement": "<b>Harvesters:</b> Required 29, Actual 31 (Adequate, Ratio 1:16). <br><b>Weeders:</b> Required 22, Actual 12 (Shortage 10). <br><b>Manurers:</b> Required 8, Actual 4 (Shortage 4). <br><b>Overall Ratio:</b> 1:23 ha (Inadequate). Recruitment is critical. (PA Report 2/2025, Pg. 12)",
                        "Staff Establishment": "<b>Staffing:</b> Satisfactory despite recent turnover. <br>En. Aminuddin (Asst In-Charge) joined Sept 2025. <br>En. Ahmad Izzudin (Asst Mgr) joined Sept 2025. <br>En. Muhammad Faiz (Asst Mgr) joined Aug 2025. (PA Report 2/2025, Pg. 13-14)",
                        "General Charges": "<b>Expenditure:</b> RM 1,302.81/ha vs Budget RM 1,555.98/ha (16% Underspent). <br>Management & Supervision cost is RM 583.18/ha. Labour & Amenities cost is RM 233.69/ha. (PA Report 2/2025, Pg. 15)",
                        "Upkeep & Cultivation": "<b>Weeding:</b> Circle spraying 88% done (Output 4.1 ha/md). Selective spraying 76% done. <br><b>Manuring:</b> 100% completed (17 rounds). Cost is 7% above budget due to price increases. <br><b>Roads:</b> Grading done at RM 10-12/chain. Hilly roads are slippery; crusher run recommended. <br><b>Pruning:</b> 100% completed; appearance satisfactory. (PA Report 2/2025, Pg. 16-28)",
                        "Harvesting and Collection": "<b>Cost:</b> RM 105.37/MT (High due to incentives). <br><b>Performance:</b> 17.4 rounds completed (Budget 20). Interval ~12 days. <br><b>Productivity:</b> Harvester outturn 68% (Unsatisfactory). Loose fruit collection at P21 needs improvement. (PA Report 2/2025, Pg. 29-31)",
                        "Crop Production": "<b>Yield:</b> 14.67 MT/ha vs Budget 10.02 MT/ha (+46%). <br><b>Comparison:</b> 5% higher than last year. <br><b>Bunch Weights:</b> Improved across all plantings (e.g., 2018 planting: 10.33 kg vs 8.9 kg last year). (PA Report 2/2025, Pg. 32-33)",
                        "Production Cost": "<b>Total Cost:</b> RM 425.23/MT (Budget RM 424.49/MT). <br><b>Breakdown:</b> General Charges (RM 205.72/MT), Upkeep (RM 114.15/MT), Harvesting (RM 105.37/MT). (PA Report 2/2025, Pg. 34)",
                        "Vehicles Running Cost": "<b>Mitsubishi Triton:</b> RM 0.48/km. <br><b>Toyota Hilux:</b> RM 0.26/km. Costs are satisfactory. (PA Report 2/2025, Pg. 35)",
                        "Immature": "<b>PR22 (197 ha):</b> Scout harvesting 2.7 MT/ha. Weeding 92% done but Lalang present. <br><b>PR23 (230 ha):</b> Manuring completed. Patches of Asystasia/VOPs remain. <br><b>PR24 (230 ha):</b> Weeding unsatisfactory; prevalent Woodies, VOPs, and Lalang. <br><b>PR25 (83 ha):</b> Planting in progress. Severe flooding in low-lying area requires drone study and drain desilting. (PA Report 2/2025, Pg. 37-50)"
                    },
                    "pinfosys": "Not Available"
                },
                "policy": "<p>Policy cross-references are not yet available for this estate.</p>"
            };

            let chartInstances = {};
            const container = document.getElementById('selected-estate-container');

            function renderEstate() {
                container.innerHTML = createEstateHTML(estateData);
                setTimeout(() => {
                    initializeChartsForEstate();
                    populateInternalDropdowns();
                    attachEventListeners();
                }, 0);
            }

            function createEstateHTML(estate) {
                const summaryMetricsHTML = Object.values(estate.summaryMetrics).map(metric => {
                    const colorClass = metric.title.includes('Area') ? 'bg-blue-50 text-blue-800' : 
                                       metric.title.includes('Yield') ? 'bg-green-50 text-green-800' :
                                       metric.title.includes('Cost') ? 'bg-red-50 text-red-800' :
                                       metric.title.includes('Weeding') ? 'bg-orange-50 text-orange-800' : 'bg-purple-50 text-purple-800';
                    if (metric.lines) {
                        return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3>${metric.lines.map(line => `<p class="text-sm">${line}</p>`).join('')}</div>`;
                    }
                    return `<div class="p-4 rounded-lg ${colorClass}"><h3 class="font-semibold">${metric.title}</h3><p class="text-2xl font-bold">${metric.value}</p><p class="text-xs text-gray-500 mt-1">${metric.note || ''}</p></div>`;
                }).join('');

                const keyMetricsHTML = estate.keyMetrics.map(metric => `
                    <div class="flex items-center space-x-3 bg-gray-50 p-3 rounded-lg">
                        <div class="bg-gray-100 p-2 rounded-full">${metric.icon}</div>
                        <div><p class="text-sm text-gray-500">${metric.label}</p><p class="font-bold text-lg">${metric.value}</p></div>
                    </div>`).join('');

                const observationsHTML = estate.observations.map(obs => `<li class="ml-4">${obs}</li>`).join('');

                return `
                    <div class="bg-white p-6 rounded-lg shadow-lg animate-fade-in">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900">${estate.name}</h2>
                        <p class="text-sm text-gray-500 mb-6 italic">${estate.reportInfo}</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 mb-8">${summaryMetricsHTML}</div>
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-4 border-b pb-2">Key Metrics & Operational Status</h3><div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-4">${keyMetricsHTML}</div></div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <div><h3 class="text-xl font-semibold mb-2">YTD Yield Comparison (MT/Ha)</h3><div class="chart-container"><canvas id="prodChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.production.note}</p></div>
                            <div><h3 class="text-xl font-semibold mb-2">Palm Age Profile</h3><div class="pie-chart-container"><canvas id="ageChart-${estate.id}"></canvas></div><p class="text-xs text-center text-gray-500 mt-2">${estate.chartData.ageProfile.note}</p></div>
                        </div>
                        <div class="mb-8"><h3 class="text-xl font-semibold mb-2 border-b pb-2">Key Observations & Issues</h3><ul class="list-disc list-inside space-y-2 text-gray-700 mt-4">${observationsHTML}</ul></div>
                        <div class="mb-8 text-center"><button class="policy-modal-btn bg-green-800 text-white px-6 py-3 rounded-lg hover:bg-green-900 transition shadow-md">View Agricultural Policy Cross-Reference</button></div>
                        <div class="space-y-2">
                            <button data-dropdown-id="${estate.id}-agronomy" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Agronomy Report Details</button>
                            <div id="${estate.id}-agronomy" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                            <button data-dropdown-id="${estate.id}-plantation" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Plantation Advisory Report Details</button>
                            <div id="${estate.id}-plantation" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200"></div>
                            <button data-dropdown-id="${estate.id}-pinfosys" class="dropdown-btn w-full text-left bg-gray-800 text-white p-3 rounded-md hover:bg-gray-700 transition">Pinfosys Report Details</button>
                            <div id="${estate.id}-pinfosys" class="details-content bg-gray-50 p-4 rounded-md border border-gray-200">.</div>
                        </div>
                    </div>`;
            }

            function initializeChartsForEstate() {
                const prodCanvasId = `prodChart-${estateData.id}`;
                const ageCanvasId = `ageChart-${estateData.id}`;
                if (chartInstances[prodCanvasId]) chartInstances[prodCanvasId].destroy();
                if (chartInstances[ageCanvasId]) chartInstances[ageCanvasId].destroy();

                const prodCtx = document.getElementById(prodCanvasId)?.getContext('2d');
                if(prodCtx) {
                    chartInstances[prodCanvasId] = new Chart(prodCtx, {
                        type: 'bar',
                        data: {
                            labels: estateData.chartData.production.labels,
                            datasets: [{
                                label: 'Yield (MT/Ha)',
                                data: estateData.chartData.production.data,
                                backgroundColor: ['#9ca3af', '#16a34a']
                            }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true } }, plugins: { legend: { display: false } } }
                    });
                }

                const ageCtx = document.getElementById(ageCanvasId)?.getContext('2d');
                if(ageCtx) {
                    chartInstances[ageCanvasId] = new Chart(ageCtx, {
                        type: 'pie',
                        data: {
                            labels: estateData.chartData.ageProfile.labels,
                            datasets: [{ data: estateData.chartData.ageProfile.data, backgroundColor: ['#facc15', '#a3e635', '#4ade80', '#fb923c'], hoverOffset: 4 }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: estateData.chartData.ageProfile.title, font: { size: 16 } }, legend: { position: 'right' } } }
                    });
                }
            }
            
            function populateInternalDropdowns() {
                const agronomyDiv = document.getElementById(`${estateData.id}-agronomy`);
                const plantationDiv = document.getElementById(`${estateData.id}-plantation`);
                const pinfosysDiv = document.getElementById(`${estateData.id}-pinfosys`);

                if (agronomyDiv && estateData.reports.agronomy) {
                    agronomyDiv.innerHTML = Object.entries(estateData.reports.agronomy).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                }
                if (plantationDiv && estateData.reports.plantation) {
                    plantationDiv.innerHTML = Object.entries(estateData.reports.plantation).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                }
                 if (pinfosysDiv) {
                    if (estateData.reports.pinfosys && estateData.reports.pinfosys !== "Not Available") {
                        pinfosysDiv.innerHTML = Object.entries(estateData.reports.pinfosys).map(([section, content]) => `<h4 class="font-semibold mt-2 text-gray-800">${section}:</h4><p class="text-sm text-gray-600">${content}</p>`).join('');
                    } else {
                         pinfosysDiv.innerHTML = `<p class="text-sm text-gray-600">Not Available</p>`;
                    }
                }
            }

            function attachEventListeners() {
                container.querySelectorAll('.dropdown-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const id = event.currentTarget.dataset.dropdownId;
                        const content = document.getElementById(id);
                        content.classList.toggle('active');
                        event.currentTarget.classList.toggle('active');
                    });
                });
                container.querySelector('.policy-modal-btn')?.addEventListener('click', openPolicyModal);
            }

            renderEstate();
        });
        
        function openPolicyModal() {
            const modal = document.getElementById('policyModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            const estateData = { "id": "simpai2", "name": "Ladang Simpai 2" }; 
            modalTitle.innerText = `Agricultural Policy Cross-Reference: ${estateData.name}`;
            
            const policyData = `
                <div class='policy-item'>
                    <p class='font-semibold'>Harvesting Standards</p>
                    <p class='text-sm text-gray-600'><b>Ref: HARV-RIPENESS-02:</b> Harvesters must ensure minimum ripeness standards. Unripe bunches/long stalks affect OER.</p>
                </div>
                <div class='policy-item'>
                    <p class='font-semibold'>Weeding Schedule</p>
                    <p class='text-sm text-gray-600'><b>Ref: UPKEEP-WEED-01:</b> Circles must be kept weed-free prior to fertilizer application to prevent nutrient loss.</p>
                </div>
                <div class='policy-item'>
                    <p class='font-semibold'>Replanting Drainage</p>
                    <p class='text-sm text-gray-600'><b>Ref: ENG-DRAIN-04:</b> Water management in replanting areas must prevent waterlogging to ensure seedling establishment.</p>
                </div>
            `;
            
            modalContent.innerHTML = policyData;
            modal.classList.add('active');
        }

        function closePolicyModal() {
            document.getElementById('policyModal').classList.remove('active');
        }
    </script>
</body>
</html>
